# Render deployment configuration
server.port=${PORT:8080}

spring.datasource.url=jdbc:postgresql://${DB_HOST:dpg-d1ombiidbo4c73b84jug-a}:${DB_PORT:5432}/${DB_NAME:lexigram_db}
spring.datasource.username=${DB_USERNAME:lexigram_db_user}
spring.datasource.password=${DB_PASSWORD:HNX0nArfBKzUIYsGhvEnGAFFZXSwG20F}

lexigram.base-url=${RENDER_EXTERNAL_URL:http://localhost:8080}
lexigram.frontend.url=${FRONTEND_URL:http://localhost:3000}
lexigram.upload.dir=/opt/lexigram/uploads/images/
lexigram.images-path=/images/

# Session cookie configuration for cross-origin (CRITICAL CHANGES)
server.servlet.session.cookie.same-site=none
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.http-only=true
# REMOVED: server.servlet.session.cookie.domain=.onrender.com (this was causing the issue)
server.servlet.session.cookie.path=/
server.servlet.session.cookie.max-age=86400
server.servlet.session.timeout=30m

# Trust proxy headers (important for Render)
server.forward-headers-strategy=framework
server.use-forward-headers=true

# OAuth2 - Production
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET}
spring.security.oauth2.client.registration.google.scope=profile,email
spring.security.oauth2.client.registration.google.redirect-uri=${RENDER_EXTERNAL_URL}/login/oauth2/code/google

# Additional logging for debugging
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web.cors=DEBUG
logging.level.org.springframework.session=DEBUG